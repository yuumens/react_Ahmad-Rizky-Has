<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="/components/stylings.css">
  <title>Create Product</title>
</head>

<body>
  <main>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container">
        <a href="#">Simple Header</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto nav-pills">
            <li class="nav-item">
              <a class="nav-link text-primary fw-light" aria-current="page" href="createAccount.html">Create Account</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active text-white" href="createAccount.html">Create Account</a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-primary fw-light" href="#">Pricing</a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-primary fw-light" href="#">FAQs</a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-primary fw-light" href="#">About</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="bootstrap-logo">
            <img src="/images/image9.png" alt="">
          </div>
          <h1>Create Product</h1>
          <p>Below is an example form built entirely with Bootstrapâ€™s form controls. Each required form group has a
            validation state that can be triggered by attempting to submit the form without completing it. </p>
          <div class="forms">
            <form class="needs-validation" novalidate>
              <div class="form-group">
                <label for="pname">Product Name: </label>
                <input type="text" class="form-control" id="pname" name="pname" required min="6" max="50">
                <div id="alertDivName" class="alert alert-danger" style="display: none;"></div>
              </div>

              <div class="form-group">
                <label for="pCategory">Product Category: </label>
                <select class="form-control text-dark" id="pCategory" name="pCategory" required>
                  <option class="text-light" value="" selected disabled>Choose...</option>
                  <option value="Mouse">Mouse</option>
                  <option value="Keyboard">Keyboard</option>
                  <option value="VGA">VGA</option>
                  <option value="Processor">Processor</option>
                </select>
                <div id="alertDivCategory" class="alert alert-danger" style="display: none;"></div>
              </div>

              <div class="form-group mb-4">
                <label for="pformFile" class="form-label">Image of Product</label>
                <input class="btn btn-primary btn-sm d-flex text-light" type="file" id="pformFile" name="pformFile" required>
                <div id="alertDivImage" class="alert alert-danger" style="display: none;"></div>
              </div>

              <div class="form-group mt-3">
                <label for="PFeatures">Product Features:</label><br>
                <input type="radio" name="PFeatures" value="Brand New" required> Brand New<br>
                <input type="radio" name="PFeatures" value="Second Hand" required> Second Hand<br>
                <input type="radio" name="PFeatures" value="Refurbished" required> Refurbished<br>
                <div id="alertDivFeatures" class="alert alert-danger" style="display: none;"></div>
              </div>


              <div class="form-group">
                <label for="descriptionInput"> Additional Description:</label><br>
                <textarea class="form-control" name="" id="" cols="30" rows="10"></textarea>
              </div>

              <div class="form-group">
                <label for="priceInput">Product Price: </label><br>
                <input type="number" id="priceInput" name="priceInput" pattern="^\$\d{1,3}(,\d{3})*(\.\d+)?$" placeholder="$100" class="form-control" required>
                <div id="alertDivPrice" class="alert alert-danger" style="display: none;"></div>
              </div>

              <div class=" m-4 d-md-flex justify-content-md-center">
                <button type="submit" class="btn btn-primary btn-block" id="submitBtn" style="--bs-btn-padding-y: .30rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">
                  Submit
                </button>
              </div>
            </form>
            <!-- Modal -->
            <div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="successModalLabel">Success!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    Product has been submitted successfully.
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>
            <br>
            <h2 class="text-center">List Product</h2>
            <table id="productTable" class="table">
              <thead>
                <tr>
                  <th>Product Name</th>
                  <th>Product Category</th>
                  <th>Product Image</th>
                  <th>Additional Description</th>
                  <th>Product Features</th>
                  <th>Product Price</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
            <div class="form-group">
              <div class="mb-2 d-md-flex row-cols-3">
                <input type="text" class="form-control" id="searchInput" placeholder="Search by Product Name">
              </div>
              <button type="button" class="btn btn-danger" id="deleteBtn">Delete</button>
              <button type="button" class="btn btn-primary" id="searchBtn">Search</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.querySelector('.needs-validation');
      const submitButton = form.querySelector('#submitBtn');
      const pnameInput = form.querySelector('#pname');
      const priceInput = form.querySelector('#priceInput');
      const alertDivName = document.getElementById('alertDivName');
      const alertDivPrice = document.getElementById('alertDivPrice');
      const alertDivImage = document.getElementById('alertDivImage');
      const alertDivCategory = document.getElementById('alertDivCategory');
      const alertDivs = form.querySelectorAll('.alert.alert-danger');

      submitButton.addEventListener('click', function(event) {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();

          //Mengecek Input yang Kosong atau Tidak
          const invalidInputs = form.querySelectorAll(':invalid');
          invalidInputs.forEach(function(input) {
            const fieldName = input.getAttribute('name');
            const fieldLabel = form.querySelector('label[for="' + fieldName + '"]').textContent;
            const alertDiv = form.querySelector('#alertDiv' + fieldName.charAt(0).toUpperCase() + fieldName.slice(1));

            if (input.validity.valid) {
              if (alertDiv) {
                alertDiv.style.display = 'none';
              }
            } else {
              if (alertDiv) {
                alertDiv.style.display = 'block';
                alertDiv.textContent = 'The ' + fieldLabel + ' field must be filled in.';
              } else {
                alertDiv = document.createElement('div');
                alertDiv.className = 'alert alert-danger';
                alertDiv.textContent = 'The ' + fieldLabel + ' field must be filled in.';
                alertDiv.id = 'alertDiv' + fieldName.charAt(0).toUpperCase() + fieldName.slice(1);

                var fieldGroup = input.closest('.form-group');
                fieldGroup.appendChild(alertDiv);
              }
            }
          });
        }

        if (/@|#|{|}/.test(pnameInput.value)) {
          pnameInput.setCustomValidity('Product Name cannot contain invalid characters.');
          alertDivName.style.display = 'block';
          alertDivName.textContent = 'Product Name cannot contain invalid characters.';
        } else {
          pnameInput.setCustomValidity('');
        }
        form.classList.add('was-validated');
      });

      form.addEventListener('input', function(event) {
        if (event.target.classList.contains('is-invalid')) {
          event.target.classList.remove('is-invalid');
          const fieldName = event.target.getAttribute('name');
          const alertDiv = form.querySelector('#alertDiv' + fieldName.charAt(0).toUpperCase() + fieldName.slice(1));
          if (alertDiv) {
            alertDiv.style.display = 'none';
          }
        }
      });

      form.addEventListener('submit', function(event) {
        event.preventDefault();
        event.stopPropagation();

        if (form.checkValidity()) {
          $('#successModal').modal('show'); //Menampilkan Modal

          const productName = pnameInput.value;
          const productCategory = document.getElementById('pCategory').value;
          const productImage = document.getElementById('pformFile').value;
          const additionalDescription = document.querySelector('textarea').value;
          const productFeaturesInput = document.querySelector('input[name="PFeatures"]:checked');
          const productFeatures = productFeaturesInput ? productFeaturesInput.value : '';
          const productPrice = priceInput.value;

          const table = document.getElementById('productTable').getElementsByTagName('tbody')[0];
          const newRow = table.insertRow(table.rows.length);
          const cell1 = newRow.insertCell(0);
          const cell2 = newRow.insertCell(1);
          const cell3 = newRow.insertCell(2);
          const cell4 = newRow.insertCell(3);
          const cell5 = newRow.insertCell(4);
          const cell6 = newRow.insertCell(5);

          //Menampilkan Data
          cell1.innerHTML = productName;
          cell2.innerHTML = productCategory;
          cell3.innerHTML = '<img src="' + productImage + '" alt="Product Image">';
          cell4.innerHTML = additionalDescription;
          cell5.innerHTML = productFeatures;
          cell6.innerHTML = productPrice;

          pnameInput.value = '';
          document.getElementById('pCategory').value = '';
          document.getElementById('pformFile').value = '';
          document.getElementById('priceInput').value = '';
          document.querySelector('textarea').value = '';
          if (productFeaturesInput) {
            productFeaturesInput.checked = false;
          }
          form.classList.remove('was-validated');
        } else {
          form.classList.add('was-validated');
        }
      });

      //Menghapus Data Terakhir Di input
      const deleteButton = document.getElementById('deleteBtn');
      deleteButton.addEventListener('click', function() {
        const table = document.getElementById('productTable').getElementsByTagName('tbody')[0];
        const rowCount = table.rows.length;

        if (rowCount > 0) {
          table.deleteRow(rowCount - 1);
        }
      });

      const searchButton = document.getElementById('searchBtn');
      const searchInput = document.getElementById('searchInput');

      //Untuk Mencari Data berdasarkan ProductName
      searchButton.addEventListener('click', function() {
        const searchTerm = searchInput.value.toLowerCase().trim();
        const table = document.getElementById('productTable').getElementsByTagName('tbody')[0];
        const rows = table.getElementsByTagName('tr');

        for (const i = 0; i < rows.length; i++) {
          const productNameCell = rows[i].getElementsByTagName('td')[0];
          if (productNameCell) {
            const productName = productNameCell.textContent.toLowerCase();
            if (productName.includes(searchTerm)) {
              rows[i].style.display = '';
            } else {
              rows[i].style.display = 'none';
            }
          }
        }
      });

      //Menutup Modal dengan closeModalButton
      const closeModalButton = document.querySelector('#successModal .btn-primary');
      closeModalButton.addEventListener('click', function() {
        $('#successModal').modal('hide'); // Menutup modal
      });

      //Membersihkan Error pada Form yang Belum Di input
      function clearError(fieldName) {
        const alertDiv = form.querySelector('#alertDiv' + fieldName.charAt(0).toUpperCase() + fieldName.slice(1));
        if (alertDiv) {
          alertDiv.style.display = 'none';
        }
      }

      form.querySelectorAll('input, select, textarea').forEach(function(input) {
        input.addEventListener('input', function() {
          const fieldName = input.getAttribute('name');
          clearError(fieldName);
        });
      });

      //Menghilangkan Error pada priceInput
      priceInput.addEventListener('input', function() {
        const fieldName = priceInput.getAttribute('name');
        clearError(fieldName);
        clearError('Price');
      });

      //Pengecekan Input pada ProductName
      pnameInput.addEventListener('input', function() {
        if (pnameInput.value.length > 25) {
          pnameInput.setCustomValidity('');
          alertDivName.style.display = 'block';
          alertDivName.textContent = 'Product Name must not exceed 25 characters.';
        } else {
          pnameInput.setCustomValidity('');
          alertDivName.style.display = 'none';
        }
      });
    });
  </script>
</body>

</html>